%Alvaro Navarro 13-10968%Maximiliano Eekhout 10-10223%Onda Triangularfrec=16;A=2;to=1/16;ts=0.0001;fs=1/ts;%t=to/4:ts:7*to/4;t=0:ts:3*to;L=length(t);f=(L/2:L/2-1);t1=0:ts:to;m=A*sawtooth(2*pi*frec.*t,0.5);figure (1), plot(t-to/4,m); title('Funcion Triangular');xlabel('tiempo (seg)');ylabel('m(t)');m1=A*sawtooth(2*pi*frec.*t1,0.5);%Potencia de la SeñalPm=(1/to).*sum(abs(m1).^2).*ts% Espectro de m Ancho de Banda de la señalM=abs(fftshift(fft(m)));lm=length(m);M=M/lm;F=-(fs-fs/lm)/2:fs/lm:(fs-fs/lm)/2;figure (2), plot(F,M); title('Ancho de Banda');xlabel('frecuencia (Hz)');ylabel('M(f)');%Señal ModuladaAc=5;fc=500;wc=fc*2*pi;mh=imag(hilbert(m));mh1=imag(hilbert(m1));s=(Ac/2).*m.*cos(t*wc)-(Ac/2).*mh.*sin(t*wc); %Banda laterial Superiorfigure (3), plot(t,s); title('Senal modulada');xlabel('tiempo (seg)');ylabel('s(t)');s1=(Ac/2).*m1.*cos(t1*wc)-(Ac/2).*mh1.*sin(t1*wc); %Potencia de la Señal moduladaPs=(1/to).*sum(abs(s1).^2).*ts%4.b Ancho de Banda de Señal Modulada S=abs(fftshift(fft(s)));ls=length(s);S=S/ls;Fs=-(fs-fs/ls)/2:fs/ls:(fs-fs/ls)/2;figure (4), plot(Fs,S); title('Espectro de Señal Modulada');xlabel('frecuencia (Hz)');ylabel('S(f)');%5. Demodulacionsd=s.*cos(t*wc);Sd=abs(fftshift(fft(sd)));  %Para graficar espectro en la entrada del filtrols=length(sd);Sd=Sd/ls;F1=-(fs-fs/ls)/2:fs/ls:(fs-fs/ls)/2;figure (5), plot(F1,Sd); title('Espectro antes del filtro');filtro=zeros(1,length(F1));for i=1:length(F1)    if F1(i)>=-fc & F1(i)<=fc        filtro(i)=1;    endendsalida = filtro.*Sd;figure (6),plot(F1,salida); title('Señal despues del filtro');%senal despues del filtro pasa bajo%Mismo procedimiento pero para una modulacion de tipo banda lateral%inferior%6.a Señal Moduladas3=(Ac/2).*m.*cos(t*wc)+(Ac/2).*mh.*sin(t*wc); %Banda laterial Inferiorfigure (7), plot(t,s3); title('Senal modulada');xlabel('tiempo (seg)');ylabel('s(t)');s4=(Ac/2).*m1.*cos(t1*wc)+(Ac/2).*mh1.*sin(t1*wc); %6.b Potencia de la Señal moduladaPs=(1/to).*sum(abs(s4).^2).*ts%6.c Ancho de Bandade Señal ModuladaS3=abs(fftshift(fft(s3)));ls3=length(s3);S3=S3/ls;Fs3=-(fs-fs/ls3)/2:fs/ls3:(fs-fs/ls3)/2;figure (8), plot(Fs3,S3); title('Espectro de la Señal Modulada');xlabel('frecuencia (Hz)');ylabel('S(f)');%7. Demodulacionsd2=s3.*cos(t*wc);Sd2=abs(fftshift(fft(sd2)));  %Para graficar espectro en la entrada del filtrols4=length(sd2);Sd2=Sd2/ls4;F2=-(fs-fs/ls4)/2:fs/ls4:(fs-fs/ls4)/2;figure (9), plot(F2,Sd2); title('Espectro antes del filtro banda lateral inferior');filtro2=zeros(1,length(F2));for i=1:length(F2)    if F2(i)>=-fc & F2(i)<=fc        filtro2(i)=1;    endendsalida2 = filtro2.*Sd2;figure (10),plot(F2,salida2); title('Espectro de señal SSB banda lateral inferior despues del filtro'); %senal despues del filtro pasa bajo%Ruido n=sqrt(Pm)*randn(1,1876);senal_nueva= n + s;figure(11), plot(t,senal_nueva); title('Señal + Ruido');sr = senal_nueva.*cos(t*wc);Sr_out=abs(fftshift(fft(sr)));  %Para graficar espectro en la entrada del filtrols3=length(sr);Sr_out=Sr_out/ls3;F3=-(fs-fs/ls3)/2:fs/ls3:(fs-fs/ls3)/2;filtro3=zeros(1,length(F3));for i=1:length(F3)    if F3(i)>=-fc & F3(i)<=fc        filtro3(i)=1;    endendsr_out2 = filtro3.*Sr_out;figure(12), plot(F3,sr_out2); title('Espectro de Señal + Ruido');Pr=mean(abs(n.^2))comp=10*log10(Pm/Pr)